google.load("visualization","1",{packages:["corechart","table","geochart"]});AnalyticsCustomReport=Garnish.Base.extend({init:function(e){this.$element=$("#"+e);this.$chartElement=$(".chart",this.$element);this.$errorElement=$(".error",this.$element);this.$totalsElement=$(".totals",this.$element);this.$chart=!1;$id=this.$element.data("widget-id");var t=new google.visualization.DataTable,n={};Craft.queueActionRequest("analytics/customReport",{id:$id},$.proxy(function(e){if(typeof e.error!="undefined"){this.$errorElement.html(e.error);this.$element.addClass("error")}else{var r=AnalyticsUtils.getColumns(e);$.each(r,function(e,n){t.addColumn(n.type,n.name)});var i=AnalyticsUtils.getRows(e);t.addRows(i);switch(e.widget.settings.options.chartType){case"AreaChart":n={theme:"maximized",colors:["#058DC7"],areaOpacity:.1,pointSize:8,lineWidth:4,hAxis:{baselineColor:"#fff",gridlines:{color:"none"}},vAxis:{baselineColor:"#ccc",gridlines:{color:"#eee"}}};this.$chart=new google.visualization.AreaChart(this.$chartElement.get(0));break;case"BarChart":this.$chart=new google.visualization.BarChart(this.$chartElement.get(0));break;case"ColumnChart":n={colors:["#058DC7"],areaOpacity:.1,pointSize:8,lineWidth:4,legend:{alignment:"automatic",position:"top",maxLines:4},hAxis:{baselineColor:"#fff",gridlines:{count:0}},vAxis:{textPosition:"in",baselineColor:"#ccc",gridlines:{color:"#eee"}},chartArea:{top:40,bottom:0,width:"100%"}};this.$chart=new google.visualization.ColumnChart(this.$chartElement.get(0));break;case"GeoChart":n={theme:"maximized",colors:["#058DC7"],region:e.widget.settings.options.region};if(e.widget.settings.options.dimension=="ga:continent"){n.resolution="continents";n.displayMode="regions"}else if(e.widget.settings.options.dimension=="ga:subContinent"){n.resolution="subcontinents";n.displayMode="regions"}else e.widget.settings.options.dimension=="ga:region"?n.resolution="provinces":e.widget.settings.options.dimension=="ga:metro"&&(n.resolution="metros");this.$chart=new google.visualization.GeoChart(this.$chartElement.get(0));break;case"PieChart":n={theme:"maximized",pieHole:.5,legend:{alignment:"center",position:"top"},chartArea:{top:40,height:"82%"},sliceVisibilityThreshold:0};this.$chart=new google.visualization.PieChart(this.$chartElement.get(0));break;case"Table":this.$chart=new google.visualization.Table(this.$chartElement.get(0))}typeof this.$chart!="undefined"&&this.$chart.draw(t,n);var s=this;$(window).resize(function(){s.$chart.draw(t,n)})}},this))}});